"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2963],{3905:function(t,e,n){n.d(e,{Zo:function(){return l},kt:function(){return h}});var r=n(7294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var c=r.createContext({}),s=function(t){var e=r.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},l=function(t){var e=s(t.components);return r.createElement(c.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},f=r.forwardRef((function(t,e){var n=t.components,i=t.mdxType,a=t.originalType,c=t.parentName,l=u(t,["components","mdxType","originalType","parentName"]),f=s(n),h=i,m=f["".concat(c,".").concat(h)]||f[h]||p[h]||a;return n?r.createElement(m,o(o({ref:e},l),{},{components:n})):r.createElement(m,o({ref:e},l))}));function h(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var a=n.length,o=new Array(a);o[0]=f;var u={};for(var c in e)hasOwnProperty.call(e,c)&&(u[c]=e[c]);u.originalType=t,u.mdxType="string"==typeof t?t:i,o[1]=u;for(var s=2;s<a;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},7635:function(t,e,n){n.r(e),n.d(e,{frontMatter:function(){return u},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return l},default:function(){return f}});var r=n(7462),i=n(3366),a=(n(7294),n(3905)),o=["components"],u={sidebar_position:3},c="Architecture",s={unversionedId:"authorize/arch",id:"authorize/arch",isDocsHomePage:!1,title:"Architecture",description:"With Caddy v2 modules (aka plugins), there is a shift in how one builds a plugin.",source:"@site/docs/authorize/arch.md",sourceDirName:"authorize",slug:"/authorize/arch",permalink:"/docs/authorize/arch",editUrl:"https://github.com/authp/authp.github.io/edit/main/docs/authorize/arch.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Plugin Overview",permalink:"/docs/authorize/intro"},next:{title:"Plugin Syntax",permalink:"/docs/authorize/syntax"}},l=[],p={toc:l};function f(t){var e=t.components,n=(0,i.Z)(t,o);return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"architecture"},"Architecture"),(0,a.kt)("p",null,"With Caddy v2 modules (aka plugins), there is a shift in how one builds a plugin.\nIf a plugin is being used in multiple parts of a configuration, e.g. in different\nroutes, each part of the configuration initializes (provisions and validates) a\nnew instance of the plugin."),(0,a.kt)("p",null,"For example, this authorization plugin may be used to protect multiple routes.\nIt means that each of the routes will get its own instance of the plugin."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"How does configuration in one part affects other parts?")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'By default, a single instance of a plugin inherits "default" context.'),(0,a.kt)("li",{parentName:"ul"},'All instances of the plugin in an authorization context (e.g. "default"\nauthorization context) inherit settings from the ',(0,a.kt)("strong",{parentName:"li"},"primary")," instance in\nthe authorization context."),(0,a.kt)("li",{parentName:"ul"},"There is only one ",(0,a.kt)("strong",{parentName:"li"},"primary")," instance in an authorization context."),(0,a.kt)("li",{parentName:"ul"},"A plugin MUST have a ",(0,a.kt)("strong",{parentName:"li"},"primary")," instance in an authorization context."),(0,a.kt)("li",{parentName:"ul"},"If an instance is not a ",(0,a.kt)("strong",{parentName:"li"},"primary")," instance, and a particular configuration\nproperty is not being set, then the instance inherits the property from the\n",(0,a.kt)("strong",{parentName:"li"},"primary")," instance.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"What happens when a plugin does not have access list")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If an instance of a plugin does not have an access list, it inherits the\nconfiguration from the ",(0,a.kt)("strong",{parentName:"li"},"primary")," instance in its authorization context."),(0,a.kt)("li",{parentName:"ul"},"If a ",(0,a.kt)("strong",{parentName:"li"},"primary")," instance does not have an access list, the instances plugin\nfails.")))}f.isMDXComponent=!0}}]);